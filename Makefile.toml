[tasks.sort]
description = "Sort the Cargo.toml dependencies."
category = "Maintenance"
command = "cargo"
install_crate = "cargo-sort"
args = ["sort", "--workspace"]

[tasks.unused-deps]
description = "Detect unused dependencies in the Cargo.toml file using cargo-machete."
category = "Maintenance"
install_crate = "cargo-machete"
command = "cargo"
args = ["machete"]

[tasks.check]
description = "Perform a cargo check."
category = "Development"
command = "cargo"
args = ["check", "--workspace"]

[tasks.test]
description = "Run workspace tests."
category = "Development"
command = "cargo"
args = ["test", "--workspace"]

[tasks.fmt-check]
description = "Check code formatting."
category = "Development"
command = "cargo"
env = { RUSTUP_TOOLCHAIN = "nightly" }
args = ["fmt", "--all", "--", "--check"]

[tasks.fmt]
description = "Check code formatting."
category = "Development"
command = "cargo"
env = { RUSTUP_TOOLCHAIN = "nightly" }
args = ["fmt", "--all"]

[tasks.lint]
description = "Run Clippy linter."
category = "Development"
command = "cargo"
args = [
    "clippy",
    "--workspace",
    "--all-targets",
    "--all-features",
    "--",
    "-D",
    "warnings",
]

[tasks.dylint]
description = "Build and run all Dylint lints against the workspace."
category = "Development"
command = "cargo"
args = ["dylint", "--workspace", "--all"]
toolchain = "nightly"
workspace = false

[tasks.clean]
description = "Clean the project."
category = "Maintenance"
command = "cargo"
args = ["clean"]

[tasks.update]
description = "Update dependencies."
category = "Maintenance"
command = "cargo"
args = ["update"]

[tasks.upgrade]
description = "Upgrade dependencies to the latest versions."
category = "Maintenance"
install_crate = "cargo-upgrade"
command = "cargo"
args = ["upgrade"]

[tasks.deny]
description = "Run cargo-deny to check for license and security issues."
category = "Security"
install_crate = "cargo-deny"
command = "cargo"
args = ["deny", "check"]

[tasks.audit]
description = "Run cargo-audit to check for vulnerabilities."
category = "Security"
install_crate = "cargo-audit"
command = "cargo"
args = ["audit"]

[tasks.ci]
description = "Full CI quality check pipeline."
category = "CI"
dependencies = ["fmt-check", "check", "lint", "test", "dylint", "deny", "audit"]
workspace = false

[tasks.ci-apply]
description = "Full CI quality check pipeline with automatic fixes."
category = "CI"
dependencies = ["fmt", "check", "lint", "test", "dylint", "deny", "audit"]

[tasks.act-ci]
description = "Run GitHub Actions CI locally on Ubuntu using act."
category = "CI"
command = "act"
args = [
    "-W",
    ".github/workflows/ci.yaml",
    "-P",
    "ubuntu-latest=ghcr.io/catthehacker/ubuntu:full-latest",
    "--container-architecture",
    "linux/amd64",
    "--rm",
]
workspace = false
